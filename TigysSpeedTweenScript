-- Services
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local Workspace = game:GetService("Workspace")
local player = Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local hrp = character:WaitForChild("HumanoidRootPart")
local humanoid = character:WaitForChild("Humanoid")

-- GUI setup (circle + frame + draggable)
local screenGui = Instance.new("ScreenGui", player:WaitForChild("PlayerGui"))

local circleBtn = Instance.new("ImageButton")
circleBtn.Size = UDim2.new(0,80,0,80)
circleBtn.Position = UDim2.new(0,20,0.5,-40)
circleBtn.BackgroundTransparency = 1
circleBtn.Image = "rbxassetid://95609095181189"
circleBtn.Parent = screenGui

local circleStroke = Instance.new("UIStroke")
circleStroke.Thickness = 3
circleStroke.Parent = circleBtn

-- Rainbow stroke
local hue = 0
RunService.RenderStepped:Connect(function()
	hue = (hue + 0.005) % 1
	circleStroke.Color = Color3.fromHSV(hue, 1, 1)
end)

-- Frame
local frame = Instance.new("Frame")
frame.Size = UDim2.new(0,260,0,140)
frame.Position = UDim2.new(0.5,-130,0.5,-70)
frame.BackgroundColor3 = Color3.fromRGB(10,10,10)
frame.BackgroundTransparency = 0.2
frame.Visible = false
frame.Active = true
frame.Draggable = true
frame.Parent = screenGui

local frameStroke = Instance.new("UIStroke")
frameStroke.Thickness = 3
frameStroke.Parent = frame

RunService.RenderStepped:Connect(function()
	frameStroke.Color = Color3.fromHSV(hue, 1, 1)
end)

local title = Instance.new("TextLabel")
title.Size = UDim2.new(1,0,0,40)
title.BackgroundTransparency = 1
title.Text = "Tigy's Tween"
title.TextColor3 = Color3.fromRGB(255,255,255)
title.Font = Enum.Font.GothamBold
title.TextSize = 20
title.Parent = frame

-- Buttons
local function createButton(text,yPos)
	local btn = Instance.new("TextButton")
	btn.Size = UDim2.new(0.8,0,0,40)
	btn.Position = UDim2.new(0.1,0,0,yPos)
	btn.BackgroundColor3 = Color3.fromRGB(30,30,30)
	btn.TextColor3 = Color3.fromRGB(255,255,255)
	btn.Font = Enum.Font.GothamBold
	btn.TextSize = 18
	btn.Text = text
	btn.Parent = frame
	return btn
end

local setBaseBtn = createButton("Set Base",50)
local speedTweenBtn = createButton("Speed Tween To Base",95)

-- Toggle UI visibility
circleBtn.MouseButton1Click:Connect(function()
	frame.Visible = not frame.Visible
end)

-- Base CFrame
local baseCFrame = nil
setBaseBtn.MouseButton1Click:Connect(function()
	if hrp then
		baseCFrame = hrp.CFrame
		setBaseBtn.Text = "Base Set!"
		wait(1)
		setBaseBtn.Text = "Set Base"
	end
end)

-- Tween with wall avoidance
speedTweenBtn.MouseButton1Click:Connect(function()
	if not baseCFrame then
		speedTweenBtn.Text = "Set Base First!"
		wait(1)
		speedTweenBtn.Text = "Speed Tween To Base"
		return
	end

	speedTweenBtn.Text = "Tweening..."

	while hrp and baseCFrame do
		local currentPos = hrp.Position
		local targetPos = baseCFrame.Position + Vector3.new(0,5,0)
		local direction = (targetPos - currentPos)
		if direction.Magnitude < 1 then break end

		local unitDir = direction.Unit
		local stepSize = 185 * wait() -- speed 185

		-- Raycast to detect walls in front
		local ray = Ray.new(currentPos, unitDir * stepSize)
		local hitPart, hitPos = Workspace:FindPartOnRay(ray, character)
		if hitPart then
			-- Simple dodge: move slightly to the side
			local sideOffset = Vector3.new(-unitDir.Z,0,unitDir.X) * 3
			hrp.CFrame = CFrame.new(currentPos + unitDir * (stepSize/2) + sideOffset)
		else
			hrp.CFrame = CFrame.new(currentPos + unitDir * stepSize)
		end

		wait(0.03)
	end

	speedTweenBtn.Text = "Speed Tween To Base"
end)
